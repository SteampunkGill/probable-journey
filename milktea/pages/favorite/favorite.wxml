<view class="favorite-page">
  <!-- 顶部操作栏 -->
  <view class="top-bar" wx:if="{{favoriteList.length > 0 || loading}}">
    <text class="count-text">共{{ total }}件收藏</text>
    <view class="actions">
      <text class="action-btn" bindtap="toggleEditMode">
        {{ isEditMode ? '完成' : '编辑' }}
      </text>
      <text class="action-btn" bindtap="clearAll" wx:if="{{isEditMode}}">清空</text>
    </view>
  </view>

  <!-- 收藏列表 -->
  <view class="favorite-list" wx:if="{{favoriteList.length > 0}}">
    <view 
      class="favorite-item"
      wx:for="{{favoriteList}}"
      wx:key="id"
      bindtap="onProductTap"
      data-id="{{item.product.id}}"
    >
      <!-- 左侧图片 -->
      <image class="product-image" src="{{item.product.imageUrl || item.product.mainImageUrl || defaultImage}}" mode="aspectFill" />
      
      <!-- 中间信息 -->
      <view class="product-info">
        <view class="product-name">{{ item.product.name }}</view>
        <view class="product-desc" wx:if="{{item.product.description}}">{{ item.product.description }}</view>
        <view class="product-footer">
          <text class="product-price">¥{{ item.product.price }}</text>
          <text class="product-sales" wx:if="{{item.product.sales}}">已售{{ item.product.sales }}</text>
        </view>
      </view>
      
      <!-- 右侧操作 -->
      <view class="product-actions">
        <view 
          class="remove-icon" 
          wx:if="{{isEditMode}}"
          catchtap="removeFavorite"
          data-id="{{item.product.id}}"
        >🗑️</view>
        <view 
          class="add-icon" 
          wx:if="{{!isEditMode}}"
          catchtap="addToCart"
          data-id="{{item.product.id}}"
        >➕</view>
      </view>
    </view>

    <!-- 加载更多 -->
    <view class="load-more" wx:if="{{hasMore}}" bindtap="loadMore">
      {{ loading ? '加载中...' : '点击加载更多' }}
    </view>
    <view class="no-more" wx:elif="{{favoriteList.length > 0}}">
      没有更多了
    </view>
  </view>

  <!-- 空状态 -->
  <view class="empty-state" wx:if="{{favoriteList.length === 0 && !loading}}">
    <view class="empty-icon">❤️</view>
    <view class="empty-text">还没有收藏任何商品哦~</view>
    <button class="go-shopping-btn" bindtap="goToOrder">去逛逛</button>
  </view>

  <!-- 加载状态 -->
  <view class="loading-state" wx:if="{{loading && favoriteList.length === 0}}">
    <view class="loading-spinner"></view>
    <view>加载中...</view>
  </view>
</view>