<view class="user-page">
  <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
  <view class="user-header">
    <view class="user-info" bindtap="goToUserProfile">
      <image 
        src="{{userInfo.avatarUrl || userInfo.avatar || '/assets/images/icons/user.png'}}" 
        class="user-avatar"
        mode="aspectFill"
      />
      <view class="user-details">
        <text class="user-name">{{userInfo.nickname || userInfo.username || 'ç‚¹å‡»ç™»å½•'}}</text>
        <view class="user-meta" wx:if="{{userInfo}}">
          <text class="user-level">â­ {{userInfo.levelName || 'æ™®é€šä¼šå‘˜'}}</text>
          <text class="user-points">ç§¯åˆ†: {{userInfo.points || 0}}</text>
        </view>
      </view>
      <text class="iconfont icon-right"></text>
    </view>
    
    <view class="user-assets" wx:if="{{userInfo}}">
      <view class="asset-item" bindtap="goToAsset" data-type="balance">
        <text class="asset-value">Â¥{{userInfo.balance || '0.00'}}</text>
        <text class="asset-label">ä½™é¢</text>
      </view>
      <view class="asset-item" bindtap="goToAsset" data-type="coupon">
        <text class="asset-value">{{userInfo.couponCount || 0}}</text>
        <text class="asset-label">ä¼˜æƒ åˆ¸</text>
      </view>
      <view class="asset-item" bindtap="goToAsset" data-type="points">
        <text class="asset-value">{{userInfo.points || 0}}</text>
        <text class="asset-label">ç§¯åˆ†</text>
      </view>
    </view>
  </view>

  <!-- æˆ‘çš„èµ„äº§ -->
  <view class="assets-section card">
    <view class="section-header">
      <text class="section-title">ğŸ’° æˆ‘çš„èµ„äº§</text>
    </view>
    <view class="assets-grid">
      <view
        class="asset-card"
        wx:for="{{assets}}"
        wx:key="id"
        bindtap="goToAsset"
        data-type="{{item.type}}"
      >
        <view class="asset-icon" style="background: {{item.bgColor}}">
          <text class="iconfont {{item.icon}}"></text>
        </view>
        <text class="asset-name">{{item.name}}</text>
        <text class="asset-value" wx:if="{{item.value}}">{{item.value}}</text>
      </view>
    </view>
  </view>

  <!-- ä¼šå‘˜ç‰¹æƒ -->
  <view class="privilege-section card" wx:if="{{userInfo}}">
    <view class="section-header">
      <text class="section-title">ğŸ‘‘ ä¼šå‘˜ç‰¹æƒ</text>
    </view>
    <view class="privilege-list">
      <view class="privilege-item" bindtap="checkBirthdayPrivilege">
        <view class="privilege-icon">ğŸ‚</view>
        <view class="privilege-info">
          <text class="privilege-name">ç”Ÿæ—¥ç‰¹æƒ</text>
          <text class="privilege-desc">ç”Ÿæ—¥å½“æœˆäº«ä¸“å±å¥½ç¤¼</text>
        </view>
        <button class="receive-btn">å»æŸ¥çœ‹</button>
      </view>
      <view class="privilege-item" bindtap="goToOrder">
        <view class="privilege-icon">ğŸ·ï¸</view>
        <view class="privilege-info">
          <text class="privilege-name">ä¼šå‘˜ä¸“äº«ä»·</text>
          <text class="privilege-desc">éƒ¨åˆ†å•†å“äº«å—ä¼šå‘˜æŠ˜æ‰£</text>
        </view>
        <button class="receive-btn">å»ä¸‹å•</button>
      </view>
    </view>
  </view>

  <!-- å¸¸ç”¨åŠŸèƒ½ -->
  <view class="functions-section card">
    <view class="section-header">
      <text class="section-title">ğŸ“‹ å¸¸ç”¨åŠŸèƒ½</text>
    </view>
    <view class="function-list">
      <view
        class="function-item"
        wx:for="{{functions}}"
        wx:key="id"
        wx:if="{{!item.requiresAdmin || userInfo.role === 'admin'}}"
        bindtap="goToFunction"
        data-url="{{item.url}}"
      >
        <view class="function-left">
          <text class="iconfont {{item.icon}}" style="color: {{item.color}}"></text>
          <text class="function-name">{{item.name}}</text>
        </view>
        <text class="iconfont icon-right"></text>
      </view>
    </view>
  </view>

  <!-- å®¢æœä¸­å¿ƒ -->
  <view class="service-section">
    <button class="service-btn" open-type="contact">
      <text class="iconfont icon-service"></text>
      <text>åœ¨çº¿å®¢æœ</text>
    </button>
    <button class="service-btn" bindtap="makePhoneCall">
      <text class="iconfont icon-phone"></text>
      <text>ç”µè¯è”ç³»</text>
    </button>
  </view>

  <!-- è®¾ç½®å…¥å£ -->
  <view class="settings-btn" bindtap="goToSettings">
    <text class="iconfont icon-settings"></text>
    <text>è®¾ç½®</text>
  </view>
</view>