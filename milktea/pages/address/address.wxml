<view class="address-page">
  <!-- é—¨åº—é€‰æ‹©æ¨¡å¼ -->
  <block wx:if="{{type === 'select_store'}}">
    <view class="address-list" wx:if="{{storeList.length > 0}}">
      <view class="address-item selectable" 
            wx:for="{{storeList}}" 
            wx:key="id" 
            bindtap="selectStore" 
            data-item="{{item}}">
        
        <!-- é—¨åº—ä¿¡æ¯ -->
        <view class="address-info">
          <view class="name-phone">
            <text class="name">{{item.name}}</text>
            <text class="status-tag {{item.status === 'OPEN' ? 'open' : ''}}">
              {{item.status === 'OPEN' ? 'è¥ä¸šä¸­' : 'ä¼‘æ¯ä¸­'}}
            </text>
          </view>
          
          <view class="address-detail">
            <text class="detail">{{item.address}}</text>
          </view>
          
          <view class="store-meta" wx:if="{{item.distance}}">
            <text class="distance">è·ç¦»æ‚¨ {{item.distanceStr}}km</text>
            <text class="hours" wx:if="{{item.businessHours}}">è¥ä¸šæ—¶é—´: {{item.businessHours}}</text>
          </view>
        </view>
        
        <!-- é€‰ä¸­æ ‡è®° -->
        <view class="selected-mark" wx:if="{{selectedStoreId === item.id}}">
          <text class="icon">âœ“</text>
        </view>
      </view>
    </view>

    <!-- é—¨åº—ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:else>
      <image class="empty-icon" src="/assets/images/icons/address.png" />
      <text class="empty-text">æš‚æ— é—¨åº—</text>
    </view>
  </block>

  <!-- åœ°å€ç®¡ç†æ¨¡å¼ -->
  <block wx:else>
    <!-- Tab åˆ‡æ¢ -->
    <view class="address-tabs">
      <view class="tab-item {{activeTab === 'mine' ? 'active' : ''}}" bindtap="switchTab" data-tab="mine">æˆ‘çš„åœ°å€</view>
      <view class="tab-item {{activeTab === 'history' ? 'active' : ''}}" bindtap="switchTab" data-tab="history">å†å²è®°å½•</view>
    </view>

    <!-- æˆ‘çš„åœ°å€åˆ—è¡¨ -->
    <view wx:if="{{activeTab === 'mine'}}">
      <view class="address-list" wx:if="{{addressList.length > 0}}">
        <view class="address-item {{mode === 'select' ? 'selectable' : ''}}" 
              wx:for="{{addressList}}" 
              wx:key="id" 
              bindtap="onAddressClick" 
              data-item="{{item}}">
          
          <!-- é»˜è®¤æ ‡ç­¾ -->
          <view class="default-badge" wx:if="{{item.isDefault}}">é»˜è®¤</view>
          
          <!-- åœ°å€ä¿¡æ¯ -->
          <view class="address-info">
            <view class="name-phone">
              <text class="name">{{item.name}}</text>
              <text class="phone">{{item.phone}}</text>
            </view>
            
            <view class="address-detail">
              <text class="tag" wx:if="{{item.tag || item.label}}">{{item.tag || item.label}}</text>
              <text class="detail">{{item.province}} {{item.city}} {{item.district}} {{item.detail}}</text>
            </view>
          </view>
          
          <!-- æ“ä½œæŒ‰é’® -->
          <view class="address-actions" wx:if="{{mode === 'list'}}">
            <view class="action-left" catchtap="toggleDefault" data-id="{{item.id}}">
              <checkbox value="{{item.id}}" checked="{{item.isDefault}}" color="#a0522d" />
              <text class="action-label">è®¾ä¸ºé»˜è®¤</text>
            </view>
            
            <view class="action-right">
              <view class="action-btn edit" catchtap="editAddress" data-id="{{item.id}}">
                <text class="icon">âœï¸</text>
                <text>ç¼–è¾‘</text>
              </view>
              <view class="action-btn delete" catchtap="deleteAddress" data-item="{{item}}">
                <text class="icon">ğŸ—‘ï¸</text>
                <text>åˆ é™¤</text>
              </view>
            </view>
          </view>
          
          <!-- é€‰ä¸­æ ‡è®°ï¼ˆé€‰æ‹©æ¨¡å¼ï¼‰ -->
          <view class="selected-mark" wx:if="{{mode === 'select' && selectedId == item.id}}">
            <text class="icon">âœ“</text>
          </view>
        </view>
      </view>

      <!-- åœ°å€ç©ºçŠ¶æ€ -->
      <view class="empty-state" wx:else>
        <image class="empty-icon" src="/assets/images/icons/address.png" />
        <text class="empty-text">æš‚æ— æ”¶è´§åœ°å€</text>
      </view>
    </view>

    <!-- å†å²è®°å½•åˆ—è¡¨ -->
    <view wx:if="{{activeTab === 'history'}}">
      <view class="address-list" wx:if="{{historyList.length > 0}}">
        <view class="address-item history" 
              wx:for="{{historyList}}" 
              wx:key="id" 
              bindtap="onAddressClick" 
              data-item="{{item}}">
          <view class="address-info">
            <view class="name-phone">
              <text class="name">{{item.name}}</text>
              <text class="phone">{{item.phone}}</text>
            </view>
            <view class="address-detail">
              <text class="detail">{{item.province}} {{item.city}} {{item.district}} {{item.detail}}</text>
            </view>
            <view class="history-meta" wx:if="{{item.usedCount}}">
              <text class="used-count">ä½¿ç”¨æ¬¡æ•°: {{item.usedCount}}</text>
            </view>
          </view>
        </view>
      </view>
      <view class="empty-state" wx:else>
        <image class="empty-icon" src="/assets/images/icons/address.png" />
        <text class="empty-text">æš‚æ— å†å²åœ°å€</text>
      </view>
    </view>

    <!-- åº•éƒ¨æ·»åŠ æŒ‰é’® -->
    <view class="footer">
      <button class="add-btn" bindtap="addAddress">
        <text class="icon">â•</text>
        <text>æ·»åŠ æ–°åœ°å€</text>
      </button>
    </view>
  </block>
</view>