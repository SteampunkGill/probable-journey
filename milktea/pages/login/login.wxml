<view class="login-page {{loginType}}">
  <!-- 顶部Logo和标题 -->
  <view class="header">
    <view class="logo-wrapper">
      <image src="/assets/images/icons/user.png" class="logo" mode="aspectFit" />
    </view>
    <text class="app-name">奶茶小店</text>
    <text class="subtitle">{{loginType === 'user' ? '前台用户登录' : '后台管理系统'}}</text>
  </view>

  <!-- 角色切换 Tab -->
  <view class="role-tabs">
    <view 
      class="tab-item {{loginType === 'user' ? 'active' : ''}}" 
      bindtap="switchRole" 
      data-role="user"
    >
      <text class="iconfont icon-user"></text>
      前台用户
    </view>
    <view 
      class="tab-item {{loginType === 'admin' ? 'active' : ''}}" 
      bindtap="switchRole" 
      data-role="admin"
    >
      <text class="iconfont icon-lock"></text>
      后台管理
    </view>
    <view class="tab-slider" style="left: {{loginType === 'user' ? '0' : '50%'}}"></view>
  </view>

  <!-- 登录卡片 -->
  <view class="login-card">
    <view class="form-content">
      <!-- 用户名输入框 -->
      <view class="form-group">
        <view class="input-wrapper {{isFocusUsername ? 'input-focus' : ''}}">
          <text class="iconfont icon-user"></text>
          <input 
            type="text" 
            placeholder="{{loginType === 'user' ? '请输入用户名/手机号' : '请输入管理员账号'}}" 
            class="input-field"
            value="{{username}}"
            bindinput="onUsernameInput"
            bindfocus="onUsernameFocus"
            bindblur="onUsernameBlur"
          />
          <view wx:if="{{username}}" class="clear-btn" bindtap="clearUsername">
            <text class="iconfont icon-close"></text>
          </view>
        </view>
      </view>

      <!-- 密码输入框 -->
      <view class="form-group">
        <view class="input-wrapper {{isFocusPassword ? 'input-focus' : ''}}">
          <text class="iconfont icon-lock"></text>
          <input 
            password="{{!showPassword}}" 
            placeholder="请输入密码" 
            class="input-field"
            value="{{password}}"
            bindinput="onPasswordInput"
            bindfocus="onPasswordFocus"
            bindblur="onPasswordBlur"
          />
          <view class="eye-icon" bindtap="togglePassword">
            <text class="iconfont {{showPassword ? 'icon-eye-open' : 'icon-eye-close'}}"></text>
          </view>
        </view>
      </view>

      <!-- 记住我 -->
      <view class="form-options">
        <label class="remember-label" bindtap="toggleRemember">
          <checkbox checked="{{rememberMe}}" color="#a0522d" />
          <text class="remember-text">记住密码</text>
        </label>
      </view>

      <!-- 登录按钮 -->
      <button 
        class="login-btn" 
        bindtap="handleLogin"
        disabled="{{loading || (loginType === 'user' && !agreed)}}"
      >
        <text wx:if="{{loading}}" class="loading-icon iconfont icon-loading"></text>
        {{loading ? '登录中...' : '立即登录'}}
      </button>
    </view>

    <!-- 底部操作 (仅前台用户显示) -->
    <view wx:if="{{loginType === 'user'}}" class="bottom-actions">
      <text class="no-account">还没有账号？</text>
      <text class="action-text register-link" bindtap="goToRegister">立即注册</text>
    </view>
  </view>

  <!-- 协议区域 (仅前台用户显示) -->
  <view wx:if="{{loginType === 'user'}}" class="agreement-section">
    <checkbox checked="{{agreed}}" bindtap="toggleAgreed" color="#a0522d" />
    <view class="agreement-text">
      我已阅读并同意<text class="agreement-link" bindtap="goToAgreement" data-type="user">《用户协议》</text>和<text class="agreement-link" bindtap="goToAgreement" data-type="privacy">《隐私政策》</text>
    </view>
  </view>

  <!-- 其他登录方式 (仅前台用户显示) -->
  <view wx:if="{{loginType === 'user'}}" class="other-login">
    <view class="divider">
      <text>其他方式登录</text>
    </view>
    <view class="other-options">
      <view class="other-item" bindtap="handleWechatLogin">
        <view class="icon-circle wechat">
          <text class="iconfont icon-wechat"></text>
        </view>
        <text>微信登录</text>
      </view>
    </view>
  </view>

  <!-- 游客登录 -->
  <view wx:if="{{loginType === 'user'}}" class="guest-login" bindtap="goToHomeAsGuest">
    <text class="guest-text">先逛逛，暂不登录</text>
  </view>
</view>