<view class="mall-page">
  <!-- ç§¯åˆ†ä¿¡æ¯å¡ç‰‡ -->
  <view class="mall-header">
    <view class="points-info-card">
      <view class="points-main">
        <view class="points-left">
          <text class="points-label">å½“å‰ç§¯åˆ†</text>
          <view class="points-value">
            <text class="points-number">{{ points }}</text>
            <text class="points-unit">ç§¯åˆ†</text>
          </view>
        </view>
        <view class="points-right" bindtap="signIn">
          <text class="exchange-label">{{ signedIn ? 'ä»Šæ—¥å·²ç­¾åˆ°' : 'ä»Šæ—¥ç­¾åˆ°' }}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- åˆ†ç±»æ ‡ç­¾ -->
  <scroll-view class="categories-section" scroll-x="{{true}}">
    <view class="categories-scroll">
      <view 
        wx:for="{{categories}}"
        wx:key="id"
        class="category-item {{activeCategoryId === item.id ? 'active' : ''}}"
        bindtap="selectCategory"
        data-id="{{item.id}}"
      >
        {{ item.name }}
      </view>
    </view>
  </scroll-view>

  <!-- å•†å“åˆ—è¡¨ -->
  <view class="products-section">
    <view class="products-grid" wx:if="{{products.length > 0}}">
      <view 
        wx:for="{{products}}"
        wx:key="id"
        class="product-card"
        bindtap="viewProductDetail"
        data-id="{{item.id}}"
      >
        <view class="product-image">
          <image src="{{item.image || '/images/default-product.jpg'}}" mode="aspectFill" />
        </view>
        <view class="product-info">
          <view class="product-name">{{ item.name }}</view>
          <view class="product-points">
            <text class="current-points">{{ item.points }}</text>
            <text class="points-unit">ç§¯åˆ†</text>
          </view>
          <button 
            class="exchange-btn" 
            catchtap="exchangeProduct" 
            data-product="{{item}}"
            disabled="{{points < item.points || item.stock <= 0}}"
          >
            {{ item.stock > 0 ? 'ç«‹å³å…‘æ¢' : 'å·²å…‘å®Œ' }}
          </button>
        </view>
      </view>
    </view>
    
    <view wx:else class="empty-state">
      <view class="empty-icon">ğŸ</view>
      <view class="empty-text">æš‚æ— å•†å“</view>
    </view>
  </view>
</view>