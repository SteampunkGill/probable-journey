<!--pages/favorite/favorite.wxml-->
<view class="favorite-page">
  <!-- 顶部操作栏 -->
  <view class="top-bar" wx:if="{{favoriteList.length > 0}}">
    <text class="count-text">共{{favoriteList.length}}件收藏</text>
    <view class="actions">
      <text class="action-btn" bindtap="toggleEditMode">
        {{isEditMode ? '完成' : '编辑'}}
      </text>
      <text class="action-btn" bindtap="clearAll" wx:if="{{isEditMode}}">清空</text>
    </view>
  </view>

  <!-- 收藏列表 -->
  <scroll-view class="favorite-list" scroll-y wx:if="{{favoriteList.length > 0}}">
    <view 
      class="favorite-item"
      wx:for="{{favoriteList}}"
      wx:key="id"
      bindtap="onProductTap"
      data-id="{{item.id}}"
    >
      <!-- 左侧图片 -->
      <image class="product-image" src="{{item.image}}" mode="aspectFill"></image>
      
      <!-- 中间信息 -->
      <view class="product-info">
        <text class="product-name">{{item.name}}</text>
        <text class="product-desc" wx:if="{{item.description}}">{{item.description}}</text>
        <view class="product-footer">
          <text class="product-price">¥{{item.price}}</text>
          <text class="product-sales" wx:if="{{item.sales}}">已售{{item.sales}}</text>
        </view>
      </view>
      
      <!-- 右侧操作 -->
      <view class="product-actions">
        <image 
          class="remove-icon" 
          src="/images/icons/delete.png"
          bindtap="removeFavorite"
          catchtap="removeFavorite"
          data-id="{{item.id}}"
          wx:if="{{isEditMode}}"
        ></image>
        <image 
          class="add-icon" 
          src="/images/icons/add.png"
          bindtap="addToCart"
          catchtap="addToCart"
          data-id="{{item.id}}"
          wx:if="{{!isEditMode}}"
        ></image>
      </view>
    </view>
  </scroll-view>

  <!-- 空状态 -->
  <view class="empty-state" wx:if="{{favoriteList.length === 0 && !loading}}">
    <image class="empty-icon" src="/images/icons/heart.png"></image>
    <text class="empty-text">还没有收藏任何商品哦~</text>
    <button class="go-shopping-btn" bindtap="goToOrder">去逛逛</button>
  </view>

  <!-- 加载状态 -->
  <view class="loading-state" wx:if="{{loading}}">
    <text>加载中...</text>
  </view>
</view>
