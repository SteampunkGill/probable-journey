<!--pages/address/address.wxml-->
<view class="address-page">
  <!-- å†å²è®°å½• -->
  <view class="history-section" wx:if="{{historyList.length > 0}}">
    <view class="section-title">å†å²è®°å½•</view>
    <view class="history-list">
      <view class="history-item" wx:for="{{historyList}}" wx:key="index" bindtap="selectAddress" data-id="{{item.id}}">
        <text class="history-tag" wx:if="{{item.tag}}">{{item.tag}}</text>
        <text class="history-address">{{item.address}} {{item.detail}}</text>
      </view>
    </view>
  </view>

  <!-- åœ°å€åˆ—è¡¨ -->
  <view class="address-list" wx:if="{{addressList.length > 0}}">
    <view class="address-item {{mode === 'select' ? 'selectable' : ''}}" 
          wx:for="{{addressList}}" 
          wx:key="id"
          bindtap="selectAddress"
          data-id="{{item.id}}">
      
      <!-- é»˜è®¤æ ‡ç­¾ -->
      <view class="default-badge" wx:if="{{item.isDefault}}">é»˜è®¤</view>
      
      <!-- åœ°å€ä¿¡æ¯ -->
      <view class="address-info">
        <view class="name-phone">
          <text class="name">{{item.name}}</text>
          <text class="phone">{{item.phone}}</text>
        </view>
        
        <view class="address-detail">
          <text class="tag" wx:if="{{item.label}}">{{item.label}}</text>
          <text class="detail">{{item.province}} {{item.city}} {{item.district}} {{item.detail}}</text>
        </view>
      </view>
      
      <!-- æ“ä½œæŒ‰é’® -->
      <view class="address-actions" wx:if="{{mode === 'list'}}">
        <view class="action-left">
          <switch checked="{{item.isDefault}}" 
                  bindchange="toggleDefault" 
                  data-id="{{item.id}}"
                  color="#D4A574"
                  catchtap="stopPropagation" />
          <text class="action-label">è®¾ä¸ºé»˜è®¤</text>
        </view>
        
        <view class="action-right">
          <button class="action-btn edit" catchtap="editAddress" data-id="{{item.id}}">
            <text class="icon">âœï¸</text>
            <text>ç¼–è¾‘</text>
          </button>
          <button class="action-btn delete" catchtap="deleteAddress" data-id="{{item.id}}">
            <text class="icon">ğŸ—‘ï¸</text>
            <text>åˆ é™¤</text>
          </button>
        </view>
      </view>
      
      <!-- é€‰ä¸­æ ‡è®°ï¼ˆé€‰æ‹©æ¨¡å¼ï¼‰ -->
      <view class="selected-mark" wx:if="{{mode === 'select' && selectedId === item.id}}">
        <text class="icon">âœ“</text>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:else>
    <image class="empty-icon" src="/images/empty/address.png" mode="aspectFit"></image>
    <text class="empty-text">æš‚æ— æ”¶è´§åœ°å€</text>
  </view>

  <!-- åº•éƒ¨æ·»åŠ æŒ‰é’® -->
  <view class="footer" wx:if="{{mode === 'list'}}">
    <button class="add-btn" bindtap="addAddress">
      <text class="icon">â•</text>
      <text>æ·»åŠ æ–°åœ°å€</text>
    </button>
  </view>
</view>
